version: "3.8"

services:
  gateway:
    build:
      context: ./gateway
    image: nazmang/nginx-gateway:1.0.0
    networks:
      - gw_net
  cloudflared:
    image: cloudflare/cloudflared:${CLOUDFLARED_TAG:-latest}
    command: tunnel run
    environment:
      TUNNEL_TOKEN: ${TUNNEL_TOKEN}
    networks:
      - gw_net

networks:
  gw_net:
    attachable: true
    driver: overlay
